/* ================================
   Guía de Estilos Institucionales • Javi
   Bootstrap 5 + Gradientes + Espejo + Glassmorphism
   Tipografía: Montserrat
================================== */

/* ---------- 1) Tokens / Variables ---------- */
:root {
    /* Colores base */
    --color-burdeos-oscuro: #35031B;
    --color-burdeos-medio: #601623;
    --color-verde-profundo: #20705B;
    --color-verde-marino: #1F7A62;
    --color-magenta-oscuro: #7E1D37;
    --color-rosa-palido: #EFD2DC;
    --color-aqua-claro: #95E5E0;
    --color-mostaza-amarillo: #C69A04;
    --color-rojo-vivo: #E24849;
    --color-amarillo-claro: #FEC747;

    /* Estados */
    --estado-operativo: var(--color-verde-profundo);
    --estado-mantenimiento: var(--color-mostaza-amarillo);
    --estado-fuera-servicio: var(--color-rojo-vivo);
    --estado-construccion: var(--color-verde-marino);

    /* Tipografía */
    --font-family: 'Montserrat', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

    /* Escalas y estética */
    --radius-xs: 6px;
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 20px;
    --radius-2xl: 28px;
    --elev-1: 0 2px 8px rgba(0, 0, 0, .08);
    --elev-2: 0 6px 16px rgba(0, 0, 0, .12);
    --elev-3: 0 10px 28px -6px rgba(0, 0, 0, .35);
    --elev-glass: 0 12px 40px rgba(0, 0, 0, .15);
    --blur-sm: 6px;
    --blur-md: 10px;
    --blur-lg: 15px;

    /* Gradientes institucionales */
    --grad-verde: linear-gradient(135deg, var(--color-verde-profundo) 0%, var(--color-verde-marino) 100%);
    --grad-burdeos: linear-gradient(135deg, var(--color-burdeos-medio) 0%, var(--color-burdeos-oscuro) 100%);
    --grad-hero: radial-gradient(circle at 25% 20%, #ffffff 0%, #f5f6f7 45%, #eceeef 100%);

    /* Focus ring */
    --ring-verde: 0 0 0 .2rem rgba(32, 112, 91, .25);

    /* ---------- Footer rojo degradado (uso en index.html y elementos.html) ---------- */
    --grad-footer-red: linear-gradient(135deg, rgba(226, 72, 73, 1) 0%, rgba(158, 24, 30, 1) 60%, rgba(123, 12, 18, 1) 100%);
    --footer-text: #fff;
    --footer-link-hover: rgba(255, 255, 255, 0.9);
}

html {
    scroll-behavior: smooth;
}

body {
    font-family: var(--font-family);
    background: var(--grad-hero);
    color: var(--color-burdeos-oscuro);
    padding-top: 0;
}

/* ---------- 2) Utilidades atómicas ---------- */
/* Glassmorphism */
.u-glass {
    background: rgba(255, 255, 255, .9);
    backdrop-filter: blur(var(--blur-md));
    -webkit-backdrop-filter: blur(var(--blur-md));
    border: 1px solid rgba(255, 255, 255, .4);
    border-radius: var(--radius-lg);
    box-shadow: var(--elev-glass);
}

.u-glass--verde {
    background: linear-gradient(135deg, rgba(255, 255, 255, .85), rgba(255, 255, 255, .75)) padding-box,
        linear-gradient(135deg, rgba(32, 112, 91, .25), rgba(31, 122, 98, .25)) border-box;
    border: 1px solid transparent;
}

/* Efecto espejo (reflejo superior sutil) */
.u-espejo {
    position: relative;
    overflow: hidden;
}

.u-espejo::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    opacity: .18;
    background: linear-gradient(to bottom, rgba(255, 255, 255, .65) 0%, rgba(255, 255, 255, 0) 40%);
}

/* Gradientes de marca */
.u-grad-verde {
    background: var(--grad-verde) !important;
}

.u-grad-burdeos {
    background: var(--grad-burdeos) !important;
}

/* Elevación */
.u-elev-1 {
    box-shadow: var(--elev-1);
}

.u-elev-2 {
    box-shadow: var(--elev-2);
}

.u-elev-3 {
    box-shadow: var(--elev-3);
}

/* Radios */
.u-r-xs {
    border-radius: var(--radius-xs)
}

.u-r-sm {
    border-radius: var(--radius-sm)
}

.u-r-md {
    border-radius: var(--radius-md)
}

.u-r-lg {
    border-radius: var(--radius-lg)
}

.u-r-xl {
    border-radius: var(--radius-xl)
}

.u-r-2xl {
    border-radius: var(--radius-2xl)
}

/* Focus visible */
.u-focus:focus {
    outline: none;
    box-shadow: var(--ring-verde);
}

/* Animaciones sutiles */
@keyframes riseIn {
    from {
        opacity: 0;
        transform: translateY(12px)
    }

    to {
        opacity: 1;
        transform: translateY(0)
    }
}

.u-ani-rise {
    animation: riseIn .45s ease-out both;
}

/* Impact panel responsive behavior */

/* When collapsed, hide the body but keep header (so toggle button remains accessible) */
#impact-panel.collapsed .card-body {
    display: none;
}

/* Small visual tweak for the card header to compress when body hidden */
#impact-panel .card-header {
    padding: .4rem .6rem;
    font-size: .9rem;
}

/* Add a subtle transition when showing/hiding the panel body */
#impact-panel .card-body {
    transition: max-height .28s ease, opacity .22s ease;
    padding: .5rem;
}

/* Compact calculator styles */
#impact-panel .mb-2 {
    margin-bottom: .25rem !important;
}

#impact-panel .mb-3 {
    margin-bottom: .5rem !important;
}

#impact-panel .form-check {
    margin-bottom: .25rem;
}

#impact-panel .btn-sm {
    padding: .25rem .5rem;
    font-size: .8rem;
    min-height: 32px;
}

#impact-panel .d-flex.gap-2 {
    gap: .5rem !important;
}

#impact-panel #quick-stats .card-body {
    padding: .5rem;
}

#impact-panel #indicators-list {
    margin-bottom: .5rem;
}

#impact-panel small {
    font-size: .75rem;
}

/* Ultra-compact styling for dynamically generated indicators */
#impact-panel #indicators-list .card {
    padding: 0.4rem !important;
    margin-bottom: 0.3rem !important;
}

#impact-panel #indicators-list .form-check {
    margin-bottom: 0.2rem !important;
}

#impact-panel #indicators-list .form-check-label {
    font-size: 0.75rem !important;
    line-height: 1.2 !important;
    margin-bottom: 0 !important;
}

#impact-panel #indicators-list .indicator-slider-container {
    margin-top: 0.3rem !important;
}

#impact-panel #indicators-list .indicator-weight-input {
    padding: 0.2rem 0.4rem !important;
    font-size: 0.75rem !important;
    height: auto !important;
    min-height: 1.6rem !important;
}

#impact-panel #indicators-list .btn-link {
    padding: 0 !important;
    font-size: 0.7rem !important;
}

#impact-panel #indicators-list .row.g-3 {
    --bs-gutter-x: 0.5rem !important;
    --bs-gutter-y: 0.3rem !important;
}

#impact-panel #indicators-list .col-12.col-md-6 {
    padding-left: 0.25rem !important;
    padding-right: 0.25rem !important;
}

/* Compact indicators grid */
#impact-panel #indicators-list .row {
    margin: 0;
    row-gap: .5rem;
}

#impact-panel #indicators-list .col-6 {
    padding: 0 .25rem;
}

#impact-panel .indicator-item {
    padding: .35rem;
    margin-bottom: .15rem;
    border-radius: .375rem;
}

#impact-panel .indicator-item .form-check {
    margin-bottom: .15rem;
}

#impact-panel .indicator-item input[type="number"] {
    padding: .25rem .5rem;
    font-size: .8rem;
    height: auto;
}

#impact-panel .indicator-item label {
    font-size: .8rem;
    margin-bottom: .15rem;
}

/* Compact form elements */
#impact-panel .form-select-sm {
    padding: .25rem .5rem;
    font-size: .8rem;
}

#impact-panel .text-muted {
    font-size: .7rem;
}

/* Ultra compact spacing */
#impact-panel .d-flex.gap-2.mb-3 {
    margin-bottom: .4rem !important;
}

#impact-panel #quick-stats {
    margin-bottom: .4rem !important;
}

#impact-panel #impact-validation {
    margin-bottom: .3rem !important;
}

#impact-panel .form-check-label {
    font-size: .8rem;
    line-height: 1.2;
}

#impact-panel .small {
    font-size: .7rem !important;
    line-height: 1.3;
}

/* Reduce vertical spacing in stats */
#impact-panel #quick-stats .row {
    margin: 0;
}

#impact-panel #quick-stats .col-6 {
    padding: .1rem .25rem;
}

/* For very small screens ensure the panel sits flush above map */
@media (max-width: 767.98px) {
    #impact-panel {
        margin-bottom: .75rem;
    }

    #map {
        height: 60vh !important;
    }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    * {
        animation: none !important;
        transition: none !important;
    }
}

/* ---------- Hover feedback for Top lists (Quick Stats and Quartiles) ---------- */
.top-list li,
.top5-item,
.topQ-item {
    cursor: pointer;
    border-radius: 6px;
    padding: 2px 6px;
    transition: background-color .15s ease, transform .12s ease;
}

.top-list li:hover,
.top5-item:hover,
.topQ-item:hover {
    background-color: rgba(32, 112, 91, 0.08); /* sutil verde institucional */
    transform: translateY(-1px);
}

.top-list li:active,
.top5-item:active,
.topQ-item:active {
    transform: translateY(0);
    background-color: rgba(32, 112, 91, 0.14);
}

/* ---------- 3) Navbar institucional ---------- */
.institutional-navbar {
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    border-bottom: 4px solid var(--color-burdeos-medio);
    box-shadow: 0 2px 10px rgba(0, 0, 0, .08);
    position: sticky;
    top: 0;
    z-index: 1030;
}

.navbar-title {
    font-size: 1.35rem;
    font-weight: 800;
    letter-spacing: .3px;
    text-transform: uppercase;
    color: var(--color-burdeos-oscuro);
}

.navbar-subtitle {
    font-size: .95rem;
    font-weight: 600;
    color: var(--color-verde-profundo);
    margin-top: .25rem;
}

.sener-logo,
.gob-logo {
    height: 60px;
    width: auto;
    object-fit: contain;
    transition: transform .3s ease;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, .1));
    border: none;
}

.sener-logo:hover,
.gob-logo:hover {
    transform: scale(1.05);
}

@media (max-width:576px) {

    .sener-logo,
    .gob-logo {
        display: none !important;
    }
}

/* ---------- 4) Botones (unificación y efectos) ---------- */
.btn {
    border-radius: var(--radius-sm);
    padding: .55rem 1rem;
    transition: transform .16s ease, box-shadow .2s ease, background .2s ease, border .16s ease;
    font-weight: 600;
    letter-spacing: .2px;
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    justify-content: center;
    min-height: 44px;
}

/* micro animation */
.btn:active {
    transform: translateY(0);
}

.btn:hover {
    transform: translateY(-2px);
}

/* PRIMARY - Verde institucional (gradiente suave con brillo) */
.btn-primary {
    color: #fff;
    background-image: linear-gradient(180deg, rgba(60, 176, 143, 1) 0%, rgba(32, 112, 91, 1) 100%);
    background-size: 100% 200%;
    border: 0;
    box-shadow: 0 6px 20px rgba(32, 112, 91, .12);
    position: relative;
    overflow: hidden;
}

.btn-primary::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(120deg, rgba(255, 255, 255, .12) 0%, rgba(255, 255, 255, 0) 60%);
    pointer-events: none;
}

.btn-primary:hover {
    background-position: 0 100%;
    box-shadow: 0 10px 30px rgba(32, 112, 91, .18);
}

.btn-primary:focus {
    outline: none;
    box-shadow: var(--ring-verde), 0 8px 24px rgba(32, 112, 91, .12);
}

.btn-primary:active {
    transform: translateY(0);
    box-shadow: 0 6px 14px rgba(32, 112, 91, .12) inset;
}

/* SECONDARY - Burdeos degradado */
.btn-secondary {
    color: #fff;
    background-image: linear-gradient(180deg, var(--color-burdeos-medio) 0%, var(--color-burdeos-oscuro) 100%);
    border: 0;
    box-shadow: 0 6px 20px rgba(96, 22, 35, .12);
}

.btn-secondary:hover {
    filter: brightness(1.03);
    box-shadow: 0 10px 30px rgba(96, 22, 35, .16);
}

.btn-secondary:focus {
    box-shadow: 0 0 0 .2rem rgba(96, 22, 35, .18);
}

/* SUCCESS - Verde profundo con brillo */
.btn-success {
    color: #fff;
    background-image: linear-gradient(180deg, #37a176 0%, var(--estado-operativo) 100%);
    border: 0;
    box-shadow: 0 6px 18px rgba(32, 112, 91, .12);
}

.btn-success:hover {
    filter: brightness(1.04);
}

/* WARNING - Mostaza / Amarillo degradado */
.btn-warning {
    color: #111;
    background-image: linear-gradient(180deg, #f6c85a 0%, var(--color-mostaza-amarillo) 100%);
    border: 0;
    box-shadow: 0 6px 18px rgba(198, 154, 4, .12);
}

.btn-warning:hover {
    filter: brightness(1.03);
}

/* DANGER - Rojo vivo degradado */
.btn-danger {
    color: #fff;
    background-image: linear-gradient(180deg, #ff6b6b 0%, var(--color-rojo-vivo) 100%);
    border: 0;
    box-shadow: 0 6px 18px rgba(226, 72, 73, .12);
}

.btn-danger:hover {
    filter: brightness(0.98);
}

/* INFO - Aqua / Teal degradado */
.btn-info {
    color: #083232;
    background-image: linear-gradient(180deg, #bff3ef 0%, var(--color-aqua-claro) 100%);
    border: 0;
    box-shadow: 0 6px 18px rgba(15, 120, 115, .06);
}

.btn-info:hover {
    filter: brightness(1.02);
}

/* OUTLINE - variante outline con borde degradado sutil */
.btn-outline {
    position: relative;
    background: transparent;
    color: var(--color-verde-profundo);
    border: 1px solid transparent;
    padding: .5rem .95rem;
}

.btn-outline::before {
    content: "";
    position: absolute;
    inset: 0;
    z-index: -1;
    border-radius: inherit;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.0), rgba(255, 255, 255, 0.0));
}

.btn-outline.primary {
    color: var(--color-verde-profundo);
    border: 1px solid rgba(32, 112, 91, .14);
    background-image: linear-gradient(180deg, rgba(32, 112, 91, .03), rgba(32, 112, 91, .02));
}

.btn-outline:hover {
    background-image: linear-gradient(180deg, rgba(32, 112, 91, .06), rgba(32, 112, 91, .02));
    transform: translateY(-2px);
}

/* Disabled / aria-disabled */
.btn[disabled],
.btn.disabled,
.btn[aria-disabled="true"] {
    opacity: .6;
    pointer-events: none;
    filter: grayscale(.02);
    transform: none;
    box-shadow: none;
}

/* Small / Large variants (keeps gradients) */
.btn-sm {
    padding: .35rem .6rem;
    height: 36px;
    font-size: .85rem;
}

.btn-lg {
    padding: .85rem 1.25rem;
    height: 52px;
    font-size: 1.05rem;
}

/* Icon-only square */
.btn-icon {
    width: 44px;
    height: 44px;
    padding: 0;
    border-radius: 10px;
    display: inline-grid;
    place-items: center;
}

/* Accessibility: visible focus for keyboard navigation */
.btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 .22rem rgba(32, 112, 91, .18);
}

/* Utility to generate soft glass sheen for any btn */
.btn--sheen::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(120deg, rgba(255, 255, 255, .08) 0%, rgba(255, 255, 255, 0) 60%);
    transition: opacity .2s ease;
    opacity: .9;
}

.btn--sheen:hover::after {
    opacity: 1;
}

/* ---------- 5) Formularios, tablas, tarjetas, modales ---------- */
.form-control {
    border-radius: var(--radius-sm);
}

.form-control:focus {
    border-color: var(--color-verde-profundo);
    box-shadow: var(--ring-verde);
}

.form-check-input:checked {
    background-color: var(--color-verde-profundo);
    border-color: var(--color-verde-profundo);
}

.table {
    border-color: rgba(0, 0, 0, .08);
}

.table thead th {
    background: var(--grad-verde);
    color: #fff;
    border: 0;
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(32, 112, 91, .03);
}

.card {
    border: 1px solid rgba(0, 0, 0, .06);
    border-radius: var(--radius-lg);
    box-shadow: var(--elev-1);
}

.card-header {
    background: var(--grad-burdeos);
    color: #fff;
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

/* Alertas */
.alert {
    border-radius: var(--radius-sm);
}

.alert-primary {
    background: var(--color-rosa-palido);
    border-color: var(--color-burdeos-medio);
    color: var(--color-burdeos-oscuro);
}

.alert-secondary {
    background: #f8f9fa;
    color: #212529;
    border-color: #ced4da;
}

/* Badges y progress */
.badge {
    border-radius: var(--radius-sm);
}

.progress {
    border-radius: var(--radius-sm);
}

.progress-bar {
    background: linear-gradient(90deg, var(--color-verde-profundo) 0%, var(--color-verde-marino) 50%, var(--color-aqua-claro) 100%);
    border-radius: 10px;
    transition: width .3s ease;
}

/* Paginación */
.pagination .page-link {
    color: var(--color-verde-profundo);
}

.pagination .page-item.active .page-link {
    background: var(--color-verde-profundo);
    border-color: var(--color-verde-profundo);
}

/* Modales */
.modal-content {
    border-radius: var(--radius-lg);
    box-shadow: var(--elev-2);
}

.modal-header {
    background: var(--grad-burdeos);
    color: #fff;
}

/* ---------- 6) Tooltips y Popovers ---------- */
.tooltip-inner {
    background-color: var(--color-burdeos-oscuro);
    color: #fff;
    border-radius: var(--radius-sm);
    padding: 8px 12px;
    font-size: .85rem;
}

.tooltip.bs-tooltip-top .tooltip-arrow::before {
    border-top-color: var(--color-burdeos-oscuro);
}

.tooltip.bs-tooltip-bottom .tooltip-arrow::before {
    border-bottom-color: var(--color-burdeos-oscuro);
}

.tooltip.bs-tooltip-start .tooltip-arrow::before {
    border-left-color: var(--color-burdeos-oscuro);
}

.tooltip.bs-tooltip-end .tooltip-arrow::before {
    border-right-color: var(--color-burdeos-oscuro);
}

.popover-header {
    background-color: var(--color-burdeos-medio);
    color: #fff;
    border-top-left-radius: var(--radius-sm);
    border-top-right-radius: var(--radius-sm);
    font-weight: 700;
}

.popover-body {
    background-color: #fff;
    color: var(--color-burdeos-oscuro);
    border-bottom-left-radius: var(--radius-sm);
    border-bottom-right-radius: var(--radius-sm);
}

.popover.bs-popover-top .popover-arrow::before {
    border-top-color: var(--color-burdeos-medio);
}

.popover.bs-popover-bottom .popover-arrow::before {
    border-bottom-color: var(--color-burdeos-medio);
}

.popover.bs-popover-start .popover-arrow::before {
    border-left-color: var(--color-burdeos-medio);
}

.popover.bs-popover-end .popover-arrow::before {
    border-right-color: var(--color-burdeos-medio);
}

/* ---------- 7) Leaflet / Mapas ---------- */
#map {
    width: 100%;
    height: 62vh;
    border-radius: 18px;
    box-shadow: var(--elev-3);
    border: 1px solid rgba(255, 255, 255, 0.25);
    overflow: hidden;
}

@media (min-width: 992px) {
    #map {
        height: 70vh;
    }
}

#map-container {
    position: relative;
    margin-bottom: 2rem;
}

#map-container::before {
    content: '';
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    z-index: -1;
    border-radius: 28px;
    background: linear-gradient(135deg, rgba(32, 112, 91, .1) 0%, rgba(96, 22, 35, .1) 50%, rgba(126, 29, 55, .1) 100%);
}

/* Botón centrado */
#center-map-btn {
    position: absolute;
    bottom: 30px;
    left: 10px;
    z-index: 400;
    background: rgba(255, 255, 255, .95);
    color: var(--color-verde-profundo);
    border: 1px solid rgba(32, 112, 91, .3);
    border-radius: 12px;
    padding: 0;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: 700;
    box-shadow: 0 4px 16px rgba(0, 0, 0, .1);
    backdrop-filter: blur(10px);
    transition: all .3s ease;
}

#center-map-btn:hover {
    background: var(--color-magenta-oscuro);
    color: #fff;
    transform: scale(1.05);
}

/* Leaflet Controls (glass) */
.leaflet-control-layers {
    background: rgba(255, 255, 255, .98) !important;
    backdrop-filter: blur(var(--blur-lg)) !important;
    -webkit-backdrop-filter: blur(var(--blur-lg)) !important;
    border: 1px solid rgba(255, 255, 255, .4) !important;
    border-radius: 16px !important;
    box-shadow: var(--elev-glass) !important;
    padding: 0 !important;
    overflow: hidden !important;
    animation: fadeInUp .5s ease-out !important;
}

.leaflet-control-layers-toggle {
    background: rgba(255, 255, 255, .95) !important;
    border-radius: 12px !important;
    width: 44px !important;
    height: 44px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border: 1px solid rgba(255, 255, 255, .4) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, .1) !important;
    transition: all .3s ease !important;
    background-image: none !important;
}

.leaflet-control-layers-toggle::before {
    content: "⚏" !important;
    font-size: 20px !important;
    color: var(--color-verde-profundo) !important;
    font-weight: 700 !important;
}

.leaflet-control-layers-toggle:hover {
    background: var(--color-verde-profundo) !important;
    transform: scale(1.05) !important;
}

.leaflet-control-layers-toggle:hover::before {
    color: #fff !important;
}

.leaflet-control-layers-expanded {
    padding: 20px !important;
    min-width: 280px !important;
}

.leaflet-control-layers-base,
.leaflet-control-layers-overlays {
    margin-bottom: 15px !important;
}

.leaflet-control-layers-separator {
    height: 2px !important;
    margin: 15px 0 !important;
    background: linear-gradient(90deg, transparent, var(--color-verde-profundo), transparent) !important;
    border: none !important;
}

.leaflet-control-layers label {
    font-family: var(--font-family) !important;
    font-weight: 500 !important;
    font-size: .9rem !important;
    color: var(--color-burdeos-oscuro) !important;
    padding: 8px 12px !important;
    margin: 4px 0 !important;
    border-radius: 8px !important;
    transition: all .3s ease !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    background: rgba(255, 255, 255, .5) !important;
    border: 1px solid rgba(0, 0, 0, .05) !important;
}

.leaflet-control-layers label:hover {
    background: rgba(32, 112, 91, .1) !important;
    border-color: var(--color-verde-profundo) !important;
    transform: translateX(4px) !important;
}

.leaflet-control-layers input[type="radio"],
.leaflet-control-layers input[type="checkbox"] {
    margin-right: 10px !important;
    transform: scale(1.2) !important;
    accent-color: var(--color-verde-profundo) !important;
}

.leaflet-control-zoom {
    border: none !important;
    border-radius: 12px !important;
    overflow: hidden !important;
    box-shadow: var(--elev-2) !important;
    animation: fadeInUp .5s ease-out !important;
}

.leaflet-control-zoom a {
    background: rgba(255, 255, 255, .98) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(255, 255, 255, .4) !important;
    color: var(--color-verde-profundo) !important;
    font-weight: 700 !important;
    font-size: 18px !important;
    transition: all .3s ease !important;
    width: 44px !important;
    height: 44px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

.leaflet-control-zoom a:hover {
    background: var(--color-verde-profundo) !important;
    color: #fff !important;
    transform: scale(1.05) !important;
}

.leaflet-control-zoom a:first-child {
    border-radius: 12px 12px 0 0 !important;
}

.leaflet-control-zoom a:last-child {
    border-radius: 0 0 12px 12px !important;
}

.leaflet-control-attribution {
    background: rgba(255, 255, 255, .9) !important;
    backdrop-filter: blur(10px) !important;
    border-radius: 8px 8px 0 0 !important;
    padding: 6px 12px !important;
    font-size: .75rem !important;
    color: var(--color-burdeos-oscuro) !important;
    border: 1px solid rgba(255, 255, 255, .4) !important;
    border-bottom: none !important;
}

.leaflet-control-attribution a {
    color: var(--color-verde-profundo) !important;
    text-decoration: none !important;
    font-weight: 500 !important;
}

.leaflet-control-attribution a:hover {
    color: var(--color-burdeos-medio) !important;
    text-decoration: underline !important;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Popups */
.leaflet-popup-content-wrapper,
.leaflet-popup-content-wrapper * {
    background: #fff !important;
}

.leaflet-popup-content-wrapper {
    background: #fff !important;
    backdrop-filter: blur(var(--blur-lg)) !important;
    -webkit-backdrop-filter: blur(var(--blur-lg)) !important;
    border: 1px solid rgba(32, 112, 91, .3) !important;
    border-radius: 12px !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, .12), 0 2px 8px rgba(32, 112, 91, .08) !important;
    padding: 0 !important;
    overflow: hidden !important;
}

.leaflet-popup-content {
    margin: 0 !important;
    padding: 20px !important;
    line-height: 1.5 !important;
    max-width: 360px !important;
    font-family: var(--font-family) !important;
    color: var(--color-burdeos-oscuro) !important;
}

.leaflet-popup-content h6 {
    margin: 0 0 12px 0 !important;
    padding: 0 0 10px 0 !important;
    font-weight: 800 !important;
    font-size: 1.1rem !important;
    text-transform: uppercase !important;
    letter-spacing: .5px !important;
    border-bottom: 2px solid var(--color-verde-profundo) !important;
}

.leaflet-popup-content .table-responsive {
    border-radius: 8px !important;
    overflow: hidden !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, .08) !important;
}

.leaflet-popup-content .table {
    margin-bottom: 0 !important;
    font-size: .9rem !important;
    background: #fff !important;
}

.leaflet-popup-content .table th {
    background: var(--grad-verde) !important;
    color: #fff !important;
    font-weight: 600 !important;
    font-size: .8rem !important;
    text-transform: uppercase !important;
    letter-spacing: .3px !important;
    padding: 12px 10px !important;
    border: none !important;
}

.leaflet-popup-content .table td {
    padding: 10px !important;
    border-bottom: 1px solid rgba(0, 0, 0, .05) !important;
    color: var(--color-burdeos-oscuro) !important;
    font-weight: 500 !important;
}

.leaflet-popup-content .table tr:nth-child(even) {
    background-color: rgba(32, 112, 91, .03) !important;
}

.leaflet-popup-content .table tr:hover {
    background-color: rgba(32, 112, 91, .08) !important;
    transition: background-color .2s ease !important;
}

.leaflet-popup-tip {
    background: #fff !important;
    border: none !important;
    box-shadow: -1px -1px 2px rgba(32, 112, 91, .05) !important;
    width: 14px !important;
    height: 14px !important;
    padding: 1px !important;
    margin: -8px auto 0 !important;
    transform: rotate(45deg) !important;
    border-top: 1px solid rgba(32, 112, 91, .3) !important;
    border-left: 1px solid rgba(32, 112, 91, .3) !important;
}

.leaflet-popup-close-button {
    color: rgba(255, 255, 255, .9) !important;
    font-size: 16px !important;
    font-weight: 700 !important;
    padding: 0 !important;
    line-height: 1 !important;
    width: 28px !important;
    height: 28px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    background: rgba(220, 53, 69, .9) !important;
    backdrop-filter: blur(10px) !important;
    border: 2px solid rgba(255, 255, 255, .3) !important;
    transition: all .3s ease !important;
    top: 8px !important;
    right: 8px !important;
    text-decoration: none !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, .15) !important;
}

.leaflet-popup-close-button:hover {
    background: rgba(220, 53, 69, 1) !important;
    color: #fff !important;
    transform: scale(1.1) rotate(90deg) !important;
    border-color: rgba(255, 255, 255, .6) !important;
}

.leaflet-popup-close-button:active {
    transform: scale(.95) !important;
}

/* ---------- 8) Footer institucional ---------- */
.main-footer {
    color: var(--color-rosa-palido);
    padding: 3rem 0;
    font-size: .9rem;
    margin-top: 3rem;
    border-top: 4px solid var(--color-verde-profundo);
    background-color: var(--color-burdeos-oscuro);
}

.main-footer h5 {
    font-weight: 700;
    font-size: 1.1rem;
    color: #fff;
}

.main-footer a {
    color: #f0f6f5;
    text-decoration: none;
    transition: color .3s ease;
}

.main-footer a:hover {
    color: var(--color-amarillo-claro);
}

.main-footer img {
    filter: brightness(0) invert(1);
    transition: filter .3s ease;
}

.main-footer img:hover {
    filter: brightness(0) invert(1) drop-shadow(0 0 8px rgba(255, 255, 255, .3));
}

/* Clase para ocultar elementos */
.oculto {
    display: none !important;
}

.detalle-municipio-item:hover {
    background-color: #f0f0f0;
}

.detalle-municipio-item.selected {
    background-color: #e0e7ff !important;
    font-weight: bold;
}

/* Estilos para el preloader */
#preloader {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100vh;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    z-index: 10000;
    backdrop-filter: blur(var(--blur-sm));
    transition: opacity .5s ease, visibility .5s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
}

#preloader img {
    animation: pulse 2s ease-in-out infinite;
}

#preloader h3 {
    font-weight: 700;
    color: var(--color-burdeos-oscuro);
    margin-bottom: .5rem;
}

#preloader p {
    color: var(--color-verde-profundo);
    font-weight: 500;
}

.spinner-border {
    color: var(--color-burdeos-medio) !important;
}

@keyframes pulse {

    0%,
    100% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: .7;
        transform: scale(1.05);
    }
}

.preloader-hide {
    opacity: 0;
    visibility: hidden;
}

/* ---------- 10) Blockquotes / Placeholders ---------- */
.blockquote {
    font-size: 1.25rem;
    font-style: italic;
    color: var(--color-burdeos-oscuro);
    border-left: 5px solid var(--color-verde-profundo);
    padding-left: 1.25rem;
}

.blockquote-footer {
    color: var(--color-verde-profundo);
    font-size: .9rem;
}

.blockquote-footer cite {
    color: var(--color-burdeos-medio);
}

#map-placeholder,
#calendar-placeholder {
    border-radius: var(--radius-lg);
    box-shadow: var(--elev-1);
    font-weight: 600;
}

/* ---------- 11) Dark Mode (prefers-color-scheme) ---------- */
/* @media (prefers-color-scheme: dark) {
    :root {
        --body-dark: #121316;
        --card-dark: #181b20;
        --text-dark: #e9e9ef;
    }

    body {
        background: radial-gradient(circle at 25% 20%, #16171a 0%, #121316 60%, #0f1012 100%);
        color: var(--text-dark);
    }

    .card {
        background: var(--card-dark);
        border-color: rgba(255, 255, 255, .06);
        box-shadow: none;
    }

    .institutional-navbar {
        background: linear-gradient(135deg, #121316 0%, #181b20 100%);
        border-bottom-color: var(--color-burdeos-medio);
    }

    .u-glass {
        background: rgba(24, 27, 32, .6);
        border-color: rgba(255, 255, 255, .08);
    }

    .table thead th {
        background: linear-gradient(135deg, #1e4f43, #195846);
    }

    .main-footer {
        border-top-color: var(--color-verde-profundo);
    }
} */

/* (Opcional) Forzar dark mode por clase .dark en <html> */
/*
html.dark body { ... }
*/

/* ---------- Footer: social icons mejoradas ---------- */
.main-footer .social-icons,
.site-footer .social-icons {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    flex-wrap: wrap;
    list-style: none;
    padding: 0;
    margin: 0;
}

.main-footer .social-icons li,
.site-footer .social-icons li {
    list-style: none;
    margin: 0;
    padding: 0;
}

/* Botón social base */
.main-footer .social-icons a,
.site-footer .social-icons a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 10px;
    color: #fff;
    text-decoration: none;
    font-size: 18px;
    transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, .12);
    background: linear-gradient(135deg, rgba(255, 255, 255, .04), rgba(255, 255, 255, .02));
    border: 1px solid rgba(255, 255, 255, .06);
}

/* Hover / focus */
.main-footer .social-icons a:hover,
.site-footer .social-icons a:hover,
.main-footer .social-icons a:focus,
.site-footer .social-icons a:focus {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, .18);
    outline: none;
}

/* Focus visible accesible */
.main-footer .social-icons a:focus-visible,
.site-footer .social-icons a:focus-visible {
    box-shadow: var(--ring-verde), 0 8px 24px rgba(0, 0, 0, .18);
}

/* Variantes por red (puedes ajustar colores) */
.social-twitter {
    background: linear-gradient(135deg, #1DA1F2, #0d8ae6);
}

.social-facebook {
    background: linear-gradient(135deg, #1877F2, #0f63d9);
}

.social-youtube {
    background: linear-gradient(135deg, #FF0000, #C70000);
}

.social-instagram {
    background: linear-gradient(135deg, #F58529, #DD2A7B);
}

.social-linkedin {
    background: linear-gradient(135deg, #0077B5, #005b8a);
}

/* Nombre (texto) visible en pantallas >= md */
.main-footer .social-icons a .social-label,
.site-footer .social-icons a .social-label {
    display: none;
    margin-left: .5rem;
    font-weight: 700;
    font-size: .9rem;
    color: #fff;
}

/* En pantallas grandes mostrar etiqueta al lado */
@media (min-width: 768px) {
    .main-footer .social-icons a {
        width: auto;
        padding: 0 .9rem;
        border-radius: 12px;
    }

    .main-footer .social-icons a .bi {
        margin-right: .4rem;
    }

    .main-footer .social-icons a .social-label {
        display: inline-block;
    }

    .site-footer .social-icons a {
        width: auto;
        padding: 0 .8rem;
    }

    .site-footer .social-icons a .social-label {
        display: inline-block;
    }
}

/* Pequeño pulso en hover para destacar */
.main-footer .social-icons a:hover::after,
.site-footer .social-icons a:hover::after {
    content: "";
    position: absolute;
    width: 80%;
    height: 80%;
    border-radius: 14px;
    top: 10%;
    left: 10%;
    pointer-events: none;
    background: radial-gradient(circle, rgba(255, 255, 255, .06), transparent 40%);
}

/* Asegurar contraste en modo disabled */
.main-footer .social-icons a[aria-disabled="true"],
.site-footer .social-icons a[aria-disabled="true"] {
    opacity: .45;
    pointer-events: none;
    transform: none;
    box-shadow: none;
}

/* ================================
   Estilos para Impacto Social
================================== */

/* Efectos hover para botones Ver de cuartiles */
#q1-toggle:hover,
#q2-toggle:hover,
#q3-toggle:hover,
#q4-toggle:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.3s ease;
}

#q1-toggle:hover {
    background-color: rgba(46, 204, 113, 0.1);
    border-color: #2ECC71;
    color: #2ECC71;
}

#q2-toggle:hover {
    background-color: rgba(241, 196, 15, 0.1);
    border-color: #F1C40F;
    color: #F1C40F;
}

#q3-toggle:hover {
    background-color: rgba(230, 126, 34, 0.1);
    border-color: #E67E22;
    color: #E67E22;
}

#q4-toggle:hover {
    background-color: rgba(192, 57, 43, 0.1);
    border-color: #C0392B;
    color: #C0392B;
}

/* Animación de pulso para botones activos */
.quartile-button-active {
    animation: quartile-pulse 1.5s infinite;
}

@keyframes quartile-pulse {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }

    100% {
        transform: scale(1);
    }
}

/* Estilos para items de municipios */
.municipality-item {
    padding: 0.5rem;
    border-radius: var(--radius-sm);
    transition: all 0.3s ease;
    border-left: 3px solid transparent;
}

.municipality-item:hover {
    background-color: rgba(0, 123, 255, 0.1);
    border-left-color: #007bff;
    transform: translateX(5px);
}

/* Estilos para el gráfico */
#chart-container {
    transition: all 0.3s ease;
}

#chart-toggle:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Resaltado de entidades en el gráfico */
.echarts-highlighted {
    opacity: 1;
}

.echarts-dimmed {
    opacity: 0.3;
}

/* ================================
   Distribución por Estados
================================== */

#states-distribution-content {
    max-height: 500px;
    overflow-y: auto;
}

.state-accordion .accordion-item {
    border: 1px solid rgba(0, 0, 0, 0.125);
    margin-bottom: 0.5rem;
    border-radius: 0.375rem;
}

.state-accordion .accordion-header button {
    background-color: #f8f9fa;
    border: none;
    font-weight: 600;
    padding: 0.75rem 1rem;
}

.state-accordion .accordion-header button:not(.collapsed) {
    background-color: #e9ecef;
    color: #495057;
}

.state-accordion .accordion-body {
    padding: 0;
}

.municipality-state-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 1rem;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: all 0.2s ease;
}

.municipality-state-item:last-child {
    border-bottom: none;
}

.municipality-state-item:hover {
    background-color: rgba(0, 123, 255, 0.05);
    transform: translateX(3px);
}

.municipality-state-item .municipality-name {
    font-weight: 500;
    color: #495057;
}

.municipality-state-item .quartile-badge {
    padding: 0.25rem 0.5rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
    min-width: 60px;
    text-align: center;
}

.quartile-badge.q1 {
    background-color: #2ECC71;
    color: white;
}

.quartile-badge.q2 {
    background-color: #F1C40F;
    color: #333;
}

.quartile-badge.q3 {
    background-color: #E67E22;
    color: white;
}

.quartile-badge.q4 {
    background-color: #C0392B;
    color: white;
}

#toggle-states-distribution {
    transition: all 0.3s ease;
}

#toggle-states-distribution:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Badges para cuartiles en popups */
.badge.q1 {
    background-color: #2ECC71 !important;
    color: white !important;
}

.badge.q2 {
    background-color: #F1C40F !important;
    color: #333 !important;
}

.badge.q3 {
    background-color: #E67E22 !important;
    color: white !important;
}

.badge.q4 {
    background-color: #C0392B !important;
    color: white !important;
}

.bg-custom-orange {
    background-color: #E67E22 !important;
    color: white;
}

/* ================================
   DataTables Customization
================================== */

#municipalities-table_wrapper .dt-buttons .btn {
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
    min-height: auto;
}

#municipalities-table_wrapper .dataTables_filter input {
    border-radius: var(--radius-sm);
    padding: 0.3rem 0.5rem;
    border: 1px solid #ced4da;
}

#municipalities-table_wrapper .dataTables_filter input:focus {
    border-color: var(--color-verde-profundo);
    box-shadow: var(--ring-verde);
}

#municipalities-table_wrapper .dataTables_paginate .page-link {
    color: var(--color-verde-profundo);
}

#municipalities-table_wrapper .dataTables_paginate .page-item.active .page-link {
    background-color: var(--color-verde-profundo);
    border-color: var(--color-verde-profundo);
}

#municipalities-table th {
    background: var(--grad-burdeos);
    color: white;
}

#municipalities-table .badge {
    font-size: 0.8rem;
    padding: 0.3em 0.6em;
}

#municipalities-table .fly-to-municipality {
    padding: 0.2rem 0.5rem;
    font-size: 0.9rem;
}

/* ================================
   noUiSlider Custom Theme
================================== */

.noUi-target {
    background: #e9ecef;
    border-radius: 8px;
    border: 1px solid #dee2e6;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.06);
    height: 12px;
}

.noUi-connect {
    background: var(--color-verde-profundo);
}

.noUi-handle {
    border: 2px solid #fff;
    border-radius: 50%;
    background: var(--color-burdeos-medio);
    box-shadow: var(--elev-1);
    cursor: grab;
}

.noUi-handle:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(32, 112, 91, .25);
}

.noUi-handle:active {
    cursor: grabbing;
    transform: scale(1.1);
}

.noUi-handle.noUi-handle-lower,
.noUi-handle.noUi-handle-upper {
    right: -12px;
    top: -6px;
    width: 24px;
    height: 24px;
}

/* Custom container for slider + input */
.indicator-slider-container {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.5rem;
}

.indicator-slider-container .indicator-slider {
    flex-grow: 1;
}

.indicator-slider-container .indicator-weight-input {
    width: 70px;
    text-align: center;
    flex-shrink: 0;
    font-weight: 600;
}

/* Estilos para el botón limpiar */
#clear-all {
    transition: all 0.3s ease;
    border-color: var(--color-gris-medio) !important;
    color: var(--color-gris-oscuro) !important;
}

#clear-all:hover {
    background-color: var(--color-gris-medio) !important;
    border-color: var(--color-gris-oscuro) !important;
    color: white !important;
    transform: translateY(-1px);
}

#clear-all:active {
    transform: translateY(0);
}

#clear-all i {
    opacity: 0.7;
}

#clear-all:hover i {
    opacity: 1;
}

/* Estilos para los marcadores Top 10 */
.top-marker {
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
    color: white;
    font-weight: bold;
    font-size: 12px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.4);
    border: 2px solid white;
}

.top-marker-best {
    background-color: #28a745; /* Verde */
}

.top-marker-worst {
    background-color: #dc3545; /* Rojo */
}

.top-marker span {
    line-height: 1;
}

.map-legend-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1.5rem;
    padding: 8px;
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-top: none;
    border-radius: 0 0 0.375rem 0.375rem;
    font-size: 0.8rem;
    margin-top: -1px; /* To align with map border */
}

.legend-item {
    display: flex;
    align-items: center;
}

.legend-color-box {
    width: 15px;
    height: 15px;
    border: 1px solid rgba(0,0,0,0.2);
    margin-right: 6px;
    display: inline-block;
}